@model WebSaludOcupacional.Models.MantenimientoModel.MantenimientoArchivosModel

@{
    ViewBag.Title = "Archivos";
    ViewBag.TextList = "Listado Maestro Archivos";
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.classModal = null;
}

<div class="col-lg-12" role="main">
    @using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()
        <div class="col-lg-12">
            <div class="card">
                <div class="card-block bg-info">
                    <h4 class="text-white card-title"><i class="fa fa-gears"></i> Mantenimiento de Archivos</h4>

                </div>
                <div class="card-block">
                    <div class="message-box contact-box">
                            <h2 class="add-ct-btn">
                                <button type="button" class="btn btn-circle btn-lg btn-success waves-effect waves-dark" id="regNuevo" name="regNuevo"
                                        data-targeturl="@Url.Action("RegistrarArchivo", "Archivo")">
                                    +
                                </button>
                            </h2>
                            <table class="table table-hover" id="tbUsurios">
                                <thead>
                                    <tr>
                                        <th style="width:10%">RUC</th>
                                        <th>Nombre</th>
                                        <th style="width:20%">E-mail</th>
                                        <th style="width:20%">N# Celular</th>
                                        <th style="width:20%">Nombre Contacto</th>
                                        </tr>
                                </thead>

                                @*<tbody>
                                    @foreach (var r in Model.lContratoes)
                                    {
                                    <tr class="odd" id="RowsCont">
                                        <td class="letra-marron">@r.RUC</td>
                                        <td class="letra-marron">@r.Name</td>
                                        <td class="letra-marron">@r.Email</td>
                                        <td class="letra-marron">@r.Cellphone</td>
                                        <td class="letra-marron">@r.Contactname</td>
                                        @if (Model.Usuario.Type.Equals(2))
                                        {
                                            <td>
                                                <button type="button" class="btn btn-danger btn-xs custom-btn details"
                                                        data-target="@Url.Action("DatosArchivo", "Archivo" , new { id=r.IDCompany})"
                                                        data-targeturl="@Url.Action("DatosArchivo", "Archivo" , new { id=r.IDCompany})">
                                                    <i class="fa fa-pencil"></i>
                                                </button>
                                                <button type="button" class="btn btn-danger btn-xs custom-btn delete"
                                                        data-target="@Url.Action("DeleteArchivo", "Archivo" , new { id=r.IDCompany})"
                                                        data-targeturl="@Url.Action("DeleteArchivo", "Archivo" , new { id=r.IDCompany})">
                                                    <i class="fa fa-remove"></i>
                                                </button>
                                            </td>
                                        }
                                    </tr>
                                    }
                                </tbody>*@
                            </table>
                        </div>
                </div>
            </div>
        </div>
        if (@ViewBag.Message != null)
        {
            if (ViewBag.Message.Estado != 0)
            {
                ViewBag.classModal = "modal-Alert-Error";
            }
            else
            {
                ViewBag.classModal = "modal-Alert-Ok";
            }
            <div id="modal-Alert" class="modal fade" tabindex="-1" role="dialog" style="overflow-y:auto;">
                <div class="modal-dialog " role="document">
                    <div class="modal-content" id="modalbody">
                        <div class="@ViewBag.classModal">
                            <button type="button" class="close Alert-Head" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <div class="modal-title letra-acl Alert-Head" id="myModalLabel">
                                <i class="mdi Alert-Head mdi-alert-outline"></i> @ViewBag.Message.Title
                            </div>
                        </div>
                        <div class="modal-body">
                            @ViewBag.Message.Message
                        </div>
                    </div>
                </div>
            </div>
        }

    }

</div>

<!-- Modal -->
<div id="modal-registro" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true" style="overflow-y:auto;">

</div>

<div id="modal-container" class="modal fade" tabindex="-1" role="dialog" style="overflow-y:auto;">

</div>

<div id="modal-Confirm-Alert" class="modal fade" tabindex="-1" role="dialog" style="overflow-y:auto;">

</div>

<script type="text/javascript">
    if (typeof NProgress != 'undefined') {
        NProgress.set(0.3)
        $(document).ready(function () {
            NProgress.done();
        });
    }

    var table = '';
    $(document).ready(function () {
        $('#modal-Alert').modal('show');
        table = $('#tbUsurios').DataTable({
            'paging': false
        });
    });

    function soloNumeros(e) {
        var key = window.Event ? e.which : e.keyCode
        return (key >= 48 && key <= 57)
    }

    $("#regNuevo").on('click', function (e) {
        showPreloader();
        $.get($(this).data("targeturl"), function (data) {
            $('<div id="modal-container" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="overflow-y:auto;" >' +
                '<div class="modal-dialog " role="document">' +
                '<div class="modal-content" id= "modalbody" >' +
                data + '</div></div>').modal('show');
            hidePreloader();
            //$("#txtClave").attr("type", "password");
            //$("#datepicker").on('focus', function (e) {
            //    $("#modal-container #datepicker").bootstrapMaterialDatePicker({ weekStart: 0, time: false });
            //    $('#datepicker').bootstrapMaterialDatePicker({ weekStart: 0, time: false });
            //});
        });
        //showPreloader();
        //console.log('click');
        //e.preventDefault();
        //$("#modal-registro").remove();
        //$.get($(this).data("targeturl"), function (data) {
        //    $('<div id="modal-container" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="overflow-y:auto;" >' +
        //        '<div class="modal-dialog " role="document">' +
        //        '<div class="modal-content" id= "modalbody" >' +
        //        data + '</div></div>').modal('show');
        //    hidePreloader();
        //    $("#txtClave").attr("type", "password");
        //});
    });

    $(".delete").on('click', function (e) {
        showPreloader();
        console.log('click');
        e.preventDefault();
        $("#modal-Confirm-Alert").remove();
        $.get($(this).data("target"), function (data) {
            $('<div id="modal-Confirm-Alert" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="overflow-y:auto;" >' +
                '<div class="modal-dialog " role="document">' +
                '<div class="modal-content" id= "modalbody" >' +
                data + '</div></div>').modal('show');
            hidePreloader();
        });
    });

    $(".details").on('click', function (e) {
        showPreloader();
        console.log('click');
        e.preventDefault();
        $("#modal-container").remove();
        $.get($(this).data("target"), function (data) {
            $('<div id="modal-container" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="overflow-y:auto;" >' +
                '<div class="modal-dialog " role="document">' +
                '<div class="modal-content" id= "modalbody" >' +
                data + '</div></div>').modal('show');
            hidePreloader();
        });
    });
</script>
